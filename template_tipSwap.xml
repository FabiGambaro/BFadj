<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<!-- Generated by BEAUTi v1.10.4 Prerelease #bc6cbd9                         -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.community/                                           -->
<beast version="1.10.4">
  <!-- The list of taxa to be analysed (can also include dates/ages).          -->
  <!-- ntax=150                                                                -->
	<taxa id="taxa">
	</taxa>
	
	<!-- The sequence alignment (each sequence refers to a taxon above).         -->
	<alignment id="alignment" dataType="nucleotide">
	</alignment>

	<!-- The unique patterns from 1 to end                                       -->
	<!-- npatterns=0                                                             -->
	<patterns id="patterns" from="1" strip="false">
		<alignment idref="alignment"/>
	</patterns>
 
  <!-- START Discrete Traits Model                                             --> 
  <!-- general data type for discrete trait model, 'regions'                   --> 
  <generalDataType id="regions.dataType"> 
  <!-- insert number of states--> 
	</generalDataType> 
 
  <!-- Data pattern for discrete trait, 'regions'                              --> 
  <attributePatterns id="regions.pattern" attribute="regions"> 
    <taxa idref="taxa"/> 
    <generalDataType idref="regions.dataType"/> 
  </attributePatterns> 
  <!-- END Discrete Traits Model                                               --> 
  
  <!-- Defining empirical tree distribution-->                           
 
   
  <!-- The strict clock (Uniform rates across branches)                        --> 
  <strictClockBranchRates id="regions.branchRates"> 
    <rate> 
      <parameter id="regions.clock.rate" value="1.0" lower="0.0"/> 
    </rate> 
  </strictClockBranchRates> 
  <rateStatistic id="regions.meanRate" name="regions.meanRate" mode="mean" internal="true" external="true"> 
    <treeModel idref="treeModel"/> 
    <strictClockBranchRates idref="regions.branchRates"/> 
  </rateStatistic> 

  <!-- START Discrete Traits Model                                             --> 
  <!-- asymmetric CTMC model for discrete state reconstructions                --> 
  <generalSubstitutionModel id="regions.model" randomizeIndicator="false"> 
    <generalDataType idref="regions.dataType"/> 
    <frequencies> 
      <frequencyModel id="regions.frequencyModel" normalize="true"> 
        <generalDataType idref="regions.dataType"/> 
        <frequencies> 
        <!-- insert regions frequencies --> 
          <!--<parameter id="regions.frequencies" dimension="7"/> --> 
        </frequencies> 
      </frequencyModel> 
    </frequencies> 
    <!-- rates and indicators                                                    --> 
    <rates> 
		<!-- insert regions rates -->
      <!--<parameter id="regions.rates" dimension="42" value="1.0" lower="0.0"/> --> 
    </rates> 
    <rateIndicator> 
      <!-- insert regions indicators -->
      <!--<parameter id="regions.indicators" dimension="42" value="1.0"/>  -->
    </rateIndicator> 
  </generalSubstitutionModel> 
  
  <sumStatistic id="regions.nonZeroRates" elementwise="true"> 
    <parameter idref="regions.indicators"/> 
  </sumStatistic> 
  <productStatistic id="regions.actualRates" elementwise="false"> 
    <parameter idref="regions.indicators"/> 
    <parameter idref="regions.rates"/> 
  </productStatistic> 
  <siteModel id="regions.siteModel"> 
    <substitutionModel> 
      <generalSubstitutionModel idref="regions.model"/> 
    </substitutionModel> 
  </siteModel> 
  
  <!-- Likelihood for tree given discrete trait data                           --> 
	<ancestralTreeLikelihood id="regions.treeLikelihood" stateTagName="regions.states" useUniformization="true" saveCompleteHistory="false" logCompleteHistory="false">
		<attributePatterns idref="regions.pattern"/>
		<treeModel idref="treeModel"/>
		<siteModel idref="regions.siteModel"/>
		<generalSubstitutionModel idref="regions.model"/>
		<strictClockBranchRates idref="regions.branchRates"/>

		<!-- The root state frequencies                                              -->
		<frequencyModel id="regions.root.frequencyModel" normalize="true">
			<generalDataType idref="regions.dataType"/>
			<frequencies>
				<!-- insert regions root frequencies -->
        		<!--<parameter id="regions.root.frequencies" dimension="7"/> -->
			</frequencies>
		</frequencyModel>
	</ancestralTreeLikelihood>
  <!-- END Discrete Traits Model                                               --> 



  <!-- Define operators                                                        --> 

  <operators id="operators" optimizationSchedule="log"> 

    <scaleOperator scaleFactor="0.75" weight="15" scaleAllIndependently="true"> 
      <parameter idref="regions.rates"/> 
    </scaleOperator> 
    <bitFlipOperator weight="7"> 
      <parameter idref="regions.indicators"/> 
    </bitFlipOperator> 
    <deltaExchange delta="0.75" weight="1"> 
      <parameter idref="regions.root.frequencies"/> 
    </deltaExchange> 

	<scaleOperator scaleFactor="0.75" weight="3">
		<parameter idref="regions.clock.rate"/>
	</scaleOperator>


    <!-- Add tipStateSwapOperator --> 
     
	<empiricalTreeDistributionOperator weight="3"> 
        <empiricalTreeDistributionModel idref="treeModel"/> 
    </empiricalTreeDistributionOperator>

     
  </operators> 
   
  <!-- Define MCMC                                                             --> 
  <mcmc id="mcmc" chainLength="20000000" autoOptimize="true" operatorAnalysis="template.ops"> 
    <joint id="joint"> 
      <prior id="prior"> 
       
        <ctmcScalePrior> 
          <ctmcScale> 
            <parameter idref="regions.clock.rate"/> 
          </ctmcScale> 
          <treeModel idref="treeModel"/> 
        </ctmcScalePrior> 
        
    <!-- Add non-zero rates prior -->
        
         
        <uniformPrior lower="0.0" upper="1.0"> 
          <parameter idref="regions.frequencies"/> 
        </uniformPrior> 
        <cachedPrior> 
          <gammaPrior shape="1.0" scale="1.0" offset="0.0"> 
            <parameter idref="regions.rates"/> 
          </gammaPrior> 
          <parameter idref="regions.rates"/> 
        </cachedPrior> 
        <uniformPrior lower="0.0" upper="1.0"> 
          <parameter idref="regions.root.frequencies"/> 
        </uniformPrior> 
         
        <strictClockBranchRates idref="regions.branchRates"/> 

        <generalSubstitutionModel idref="regions.model"/> 
      </prior> 
      
      <likelihood id="likelihood"> 
        <ancestralTreeLikelihood idref="regions.treeLikelihood"/>
      </likelihood> 
   
    </joint> 
    <operators idref="operators"/> 
     
    <!-- write log to screen                                                     --> 
    <log id="screenLog" logEvery="20000"> 
      <column label="Joint" dp="4" width="12"> 
        <joint idref="joint"/> 
      </column> 
      <column label="Prior" dp="4" width="12"> 
        <prior idref="prior"/> 
      </column> 
      <column label="Likelihood" dp="4" width="12"> 
        <likelihood idref="likelihood"/> 
      </column>  
    </log>     
     
    <!-- write log to file                                                       --> 
    <log id="fileLog" logEvery="20000" fileName="template.log" overwrite="false"> 
      <joint idref="joint"/> 
      <prior idref="prior"/> 
      <likelihood idref="likelihood"/> 
      <parameter idref="regions.clock.rate"/> 
      <parameter idref="regions.rates"/> 
      <parameter idref="regions.indicators"/> 
      <sumStatistic idref="regions.nonZeroRates"/> 
      <strictClockBranchRates idref="regions.branchRates"/> 
      <ancestralTreeLikelihood idref="regions.treeLikelihood"/>
    </log> 
    
    
    <!-- write tree log to file                                                  --> 
    <logTree id="treeFileLog" logEvery="20000" nexusFormat="true" fileName="template.trees" sortTranslationTable="true"> 
      <treeModel idref="treeModel"/> 
      <joint idref="joint"/> 
			<!-- reduce file size - only log states-->
			<trait name="regions.states" tag="region">
				<ancestralTreeLikelihood idref="regions.treeLikelihood"/>
			</trait>
    </logTree> 
  </mcmc> 
  <report> 
    <property name="timer"> 
      <mcmc idref="mcmc"/> 
    </property> 
  </report> 
</beast> 
