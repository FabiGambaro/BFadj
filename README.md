# Navigating sampling bias in discrete phylogeographic analysis: assessing the performance of an adjusted Bayes factor

Bayesian phylogeographic inference is a popular tool in molecular epidemiological studies, enabling the reconstruction of the dispersal history of rapidly evolving pathogens. Discrete phylogeographic analysis integrates geographic information as discrete characters and infers lineage transition events among discrete locations. A discrete phylogeographic analysis is typically followed by a Bayes factor (BF) test that assesses the statistical support for inferred transition links by comparing their posterior and prior expectations. In the standard BF (BF<sub>std</sub>) test approach, the relative abundance of the involved trait states is not considered, which can be problematic in the case of unbalanced sampling among discrete locations. Although several strategies have been proposed to address sampling bias in discrete phylogeographic analyses that employ continuous-time Markov chain (CTMC) modeling, they might require additional epidemiological information. In this study, we formally assess the performance of a modification of the BF<sub>std</sub>, the adjusted Bayes factor (BF<sub>adj</sub>), which attempts to incorporate information on the relative abundance of samples by location when inferring support for transition events and root location inference without requiring external data. Using a simulation framework, we assess the performance of BF<sub>std</sub> and BF<sub>adj</sub> under varying levels of sampling bias, estimating their type I (false positive) and type II (false negative) error rates. Our results show that BF<sub>adj</sub> complements the BF<sub>std</sub> (i) by reducing type I errors, leading to fewer false positive inferred transition events, but at the cost of increasing type II errors and thus decreasing statistical power, particularly in highly biased scenarios; and (ii) by simultaneously reducing both type I and type II errors when estimating statistical support associated with the inference of the root location. Our findings provide guidelines on how to implement and use the complementary BF<sub>adj</sub> to detect and mitigate the impact of sampling bias on the outcomes of discrete phylogeographic inference using CTMC modeling.

## Simulation framework

In this study, we use a simulation framework (i) to optimise the setup to calculate the BF<sub>adj</sub> and (ii) to formally evaluate the statistical performance of the BFadj, specifically assessing how well the BF<sub>adj</sub> can identify transition events or inferred root locations for which a high BF<sub>std</sub> support likely results from  high relative abundance of the involved locations (i.e., sampling biases). 

We used 30 simulated epidemics of rabies virus (RABV) in dogs in Morocco from the study of Layan and colleagues; full study is available [here](https://doi.org/10.1093/ve/vead010)
In this study RABV epidemics were simualted among domestic dog populations in Morocco using a stochastic metapopulation model. From each case, RABV whole-genomes associated with each case were simulated using a simple HKY model. Viral genomes were subsenquently sampled in a biased way to generate dataset of 150 or 500 sequences. Different degrees of samplig bias were implemented with weights increasing the sampling probability of genomes from particular regions by a factor of 2.5, 5, 10, 20, or 50. From each of the simulated transmission chains, we then extracted the “true” phylogeny linking the sampled genomes by pruning all but the sampled infections. 

Two types of discrete phylogeographic analyses were performed using the software package BEAST 1.10.5 on each of the simulated RABV datasets: a “standard discrete phylogeographic analysis” and a “tip-state-swap discrete phylogeographic analysis” where the location states at the tips were randomly permuted during the run.

## Tip-state-swap discrete phylogeographic analysis
